/*
 * seven_segment.c
 *
 *  Created on: Oct 13, 2025
 *      Author: vermi
 */


#include <seven_segment.h>

static void operate(SevenSegment* public)
{
	SevenSegmentPrivate* this = (SevenSegmentPrivate*) public;
	Timer*   timer = this->timer;
	uint16_t count = timer->get_count(timer);

	uint8_t ones_digit   = (count / 1000) % 10;
	uint8_t tenths_digit = (count /  100) % 10;

	_7SEG_SetNumber(DGT1, ones_digit, (tenths_digit < 5) ? ON : OFF);
	_7SEG_SetNumber(DGT2, tenths_digit, OFF);
}

SevenSegment* new_SevenSegment(Timer* timer)
{
	SevenSegmentPrivate* this = malloc(sizeof(SevenSegmentPrivate));

	this->public.operate  = operate;
	this->timer = timer;

	return (SevenSegment*) this;
}
